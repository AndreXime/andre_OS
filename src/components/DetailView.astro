---
import { ChevronLeft, ExternalLink } from "lucide-preact";
import Badge from "./ui/Badge.astro";
import type { Item } from "@/data/items";
import { getDomain } from "@/lib/utils";
interface Props {
    item: Item;
}

const { item } = Astro.props;

// Lógica de tema (pode ser movida para um utilitário)
const getThemeColor = () => {
    if (item.type === "tool") return "emerald";
    if (item.type === "note") return "blue";
    if (item.type === "link") return "violet";
    return "zinc";
};
const theme = getThemeColor();

const borderClass = {
    emerald: "border-emerald-500/30",
    blue: "border-blue-500/30",
    violet: "border-violet-500/30",
    zinc: "border-zinc-700",
}[theme];

const bgClass = {
    emerald: "bg-emerald-950/20",
    blue: "bg-blue-950/20",
    violet: "bg-violet-950/20",
    zinc: "bg-zinc-900",
}[theme];
---

<div class="flex flex-col w-full">
    <div class="mb-6 flex items-center gap-4 flex-shrink-0">
        <a
            href={"/"}
            class="flex items-center gap-2 px-3 py-1.5 rounded-md bg-zinc-900 border border-zinc-800 hover:border-zinc-600 hover:bg-zinc-800 text-sm transition-colors text-zinc-400 hover:text-white group"
        >
            <ChevronLeft
                size={16}
                class="group-hover:-translate-x-0.5 transition-transform"
            />
            Home
        </a>
        <div class="h-4 w-px bg-zinc-800"></div>
        <div class="flex items-center gap-2 text-xs font-mono text-zinc-500">
            <span class="uppercase">~/ {item.type}s / {item.id}</span>
        </div>
    </div>

    <div
        class={`min-h-[200px] rounded-lg border ${borderClass} bg-zinc-900/50 backdrop-blur-sm overflow-hidden flex flex-col`}
    >
        <div
            class={`p-6 md:p-8 border-b ${borderClass} ${bgClass} flex-shrink-0`}
        >
            <div class="flex gap-2 mb-4">
                {
                    item.tags?.map((tag: string) => (
                        <Badge text={`#${tag}`} color={theme} />
                    ))
                }
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-zinc-100 mb-4">
                {item.title}
            </h1>
            <div
                class="flex items-center gap-4 text-sm text-zinc-400 font-mono"
            >
                {item.date && <span>{item.date}</span>}
                {
                    item.url && (
                        <a
                            href={item.url}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="flex items-center gap-1.5 text-violet-400 hover:text-violet-300 transition-colors"
                        >
                            <ExternalLink size={14} /> {getDomain(item.url)}
                        </a>
                    )
                }
            </div>
        </div>

        <div
            class="p-6 md:p-8 overflow-y-auto flex-1 prose prose-invert prose-zinc max-w-none"
        >
            <p class="text-lg text-zinc-300 leading-relaxed mb-6">
                {item.description}
            </p>
            {
                item.content && (
                    <div class="text-zinc-400 leading-relaxed mb-6 whitespace-pre-wrap">
                        {item.content}
                    </div>
                )
            }
        </div>
    </div>
</div>
